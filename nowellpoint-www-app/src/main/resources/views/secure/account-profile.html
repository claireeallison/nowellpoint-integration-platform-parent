<#import "template.html" as t>
    <@t.page>
        <#include "navbar.html" />

        <div class="container-fluid">
            <div class="row">
            <br>
            <br>
            <div class="flextable">
                <div class="flextable-item flextable-primary">
                    <h3 class="dashhead-title">${labels["user.profile"]}</h3>
                </div>
                <div class="flextable-item">

                    <a href="#profileDialog" class="profile-dialog btn btn-primary" role="button" data-toggle="modal" data-title="${labels['edit.user.profile']}">${labels["edit"]}</a>
                </div>
            </div>
            <br>
            <div class="hr-divider"></div>
            </div>    
            <div class="row">
                <br>
                <div id="status-message"></div>
                <br>
                <br>
                <div class="col-md-2">
                    <div>
                        <img src="${(accountProfile.photos.profilePicture)!}" class="img-circle img-responsive center-block" alt="/images/person-generic.jpg">
                    </div>
                    <br>
                    <#if (accountProfile.photos.profilePicture)! !='/images/person-generic.jpg'>
                        <div class="text-center">
                            <a href="#" id="clickable" class="btn btn-primary center" role="button"> <i id="spinner" class="fa fa-spinner fa-spin"></i>${labels["delete"]}
                            </a>
                        </div>
                    </#if>

                </div>

                <div class="col-md-10">

                    <dl class="dl-horizontal">
                        <dt>${labels["first.name"]}</dt>
                        <dd>${accountProfile.firstName!}</dd>
                        <dt>${labels["last.name"]}</dt>
                        <dd>${accountProfile.lastName!}</dd>
                        <dt>${labels["company"]}</dt>
                        <dd>${accountProfile.company!}</dd>
                        <dt>${labels["division"]}</dt>
                        <dd>${accountProfile.division!}</dd>
                        <dt>${labels["department"]}</dt>
                        <dd>${accountProfile.department!}</dd>
                        <dt>${labels["title"]}</dt>
                        <dd>${accountProfile.title!}</dd>
                        <dt>${labels["fax"]}</dt>
                        <dd>${accountProfile.fax!}</dd>
                        <dt>${labels["mobile.phone"]}</dt>
                        <dd>${accountProfile.mobilePhone!}</dd>
                        <dt>${labels["phone"]}</dt>
                        <dd>${accountProfile.phone!}</dd>
                        <dt>${labels["extension"]}</dt>
                        <dd>${accountProfile.extension!}</dd>
                    </dl>

                    <br>

                    <div class="hr-divider">
                        <h3 class="hr-divider-content hr-divider-heading">${labels["address"]}</h3>
                    </div>

                    <br>

                    <dl class="dl-horizontal">
                        <dt>${labels["street"]}</dt>
                        <dd>${accountProfile.address.street!}</dd>
                        <dt>${labels["city"]}</dt>
                        <dd>${accountProfile.address.city!}</dd>
                        <dt>${labels["state"]}</dt>
                        <dd>${accountProfile.address.state!}</dd>
                        <dt>${labels["zip.postal.code"]}</dt>
                        <dd>${accountProfile.address.postalCode!}</dd>
                        <dt>${labels["country"]}</dt>
                        <dd>${accountProfile.address.countryCode!}</dd>
                    </dl>

                </div>

            </div>
            <div class="row">

                <br>


                <br>
                <br>
                <br>

                <div class="flextable">
                    <div class="flextable-item flextable-primary">
                        <h3 class="dashhead-title">${messages["payment.methods"]}</h3>
                    </div>
                    <div class="flextable-item">

                        <a href="${labels['base.path']}/${accountProfile.id}/payment-methods/new" , id="add-card" class="btn btn-primary" role="button">${labels["add.card"]}</a>

                    </div>
                </div>

                <br>
                <div class="hr-divider"></div>
                <br>



                <div class="panel-group" id="accordion">
                    <#list accountProfile.creditCards as creditCard>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#cardDetails${creditCard?counter}">
                                    <div class="flextable">
                                        <div class="flextable-item">
                                            <div class="pull-left">${labels["card.type"]}: <img src="${(creditCard.imageUrl)!}"/>&nbsp;${(creditCard.cardType)!} ${labels["ending.in"]} ${(creditCard.lastFour)!}</div>    
                                        </div>
                                        <div class="flextable-item">
                                            <div class="pull-left">${labels["expiration.date"]}: ${(creditCard.expirationMonth)!}/${(creditCard.expirationYear)!}</div>
                                        </div>
                                        <div class="flextable-item">
                                        <i class="indicator glyphicon glyphicon-chevron-down pull-right"></i>  
                                        </div>    
                                    </div>  
                                </a>    
                            </h4>
                            </div>
                            <div id="cardDetails${creditCard?counter}" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <div class="col-lg-6 col-md-6 col-sm-6">
                                        <dl class="dl-vertical">
                                            <dt>${labels["name.on.card"]}</dt>
                                            <dd>${(creditCard.cardholderName)!}</dd>
                                        </dl>
                                    </div>
                                    <div class="col-lg-6 col-md-6 col-sm-6">
                                        <dl class="dl-vertical">
                                            <dt>${labels["billing.contact"]}</dt>
                                            <dd>${(creditCard.billingContact.firstName)!} ${(creditCard.billingContact.lastName)!}</dd>
                                            <br>
                                            <dt>${labels["billing.address"]}</dt>
                                            <dd>${(creditCard.billingAddress.street)!}</dd>
                                            <dd>${(creditCard.billingAddress.city)!}, ${(creditCard.billingAddress.state)!} ${(creditCard.billingAddress.postalCode)!}</dd>
                                            <dd>${(creditCard.billingAddress.country)!}</dd>
                                        </dl>
                                    </div>
                                    <div class="col-lg-12 col-md-12 col-sm-12">
                                        <div class="pull-right">
                                            <a href="#" class="btn btn-default confirm-delete" data-toggle="modal" aria-hidden="true" data-id="${creditCard.token}" data-message="${(creditCard.cardType)!} ${labels['ending.in']} ${(creditCard.lastFour)!}" data-title="${labels['remove.card']}" role="button">${labels["delete"]}</a>
                                            <a href="#" class="btn btn-default" data-id="${creditCard.token}" role="button">${labels["edit"]}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </#list>
                </div>
            </div>
        </div>

        <#include "account-profile-edit.html"/>

        <script>
            $(document).ready(function(e) {
                $('#clickable').click(function(e) {
                    e.preventDefault();
                    $.ajax({
                        type: "DELETE",
                        url: "/app/account-profile/picture",
                        success: function() {
                            location.reload();
                        }
                    });
                });
            });
        </script>

    </@t.page>