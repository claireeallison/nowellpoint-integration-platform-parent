<#import "template.html" as t>

    <@t.page>

        <#include "navbar.html" />

        <div class="container-fluid container-fluid-spacious">
            <div class="dashhead m-t-md">
                <div class="dashhead">
                    <div class="dashhead-titles">
                        <h6 class="dashhead-subtitle">${serviceInstance.providerName!}</h6>
                        <h2 class="dashhead-title">${labels["outbound.message.setup"]}</h2>
                    </div>
                    <div class="dashhead-toolbar">
                        <p class="pull-right">

                        </p>
                    </div>
                </div>
            </div>

            <br>

            <div class="hr-divider">

            </div>

            <br>

            <div class="row">
                <div class="col-sm-1">
                    <#include "salesforce-service-nav.html" />
                </div>

                <div class="col-sm-11">

                    <div class="col-sm-1">

                        <div>
                            <span class="icon icon-folder fa-4x"></span>
                        </div>

                    </div>

                    <div class="col-sm-9">

                        <dl class="dl-horizontal">

                            <dt>${labels["connector"]}</dt>
                            <dd><a href="/app/connectors/salesforce/connector/${(salesforceConnector.id)!}">${(salesforceConnector.id)!}</a></dd>

                            <dt>${labels["id"]}</dt>
                            <dd>${(salesforceConnector.identity.id)!}</dd>

                            <dt>${labels["name"]}</dt>
                            <dd>${(salesforceConnector.organization.name)!}</dd>

                            <dt>${labels["organization.type"]}</dt>
                            <dd>${(salesforceConnector.organization.organizationType)!}</dd>

                            <dt>${labels["instance.name"]}</dt>
                            <dd>${(salesforceConnector.organization.instanceName)!}</dd>

                        </dl>
                        
                        <br>
                        
                         <p class="text-danger">
                            ${labels["delete.warning"]}
                        </p>

                        <a href="" class="btn btn-lg btn-danger-outline confirm-delete" title="${labels['delete.service']}" data-toggle="modal" aria-hidden="true" role="button" data-id="${serviceInstance.key!}" data-message="${serviceInstance.serviceName!}" data-title="${deleteMessage}">${labels["delete.service"]}</a>


                    </div>

                    <div class="col-sm-2">

                        <select id="environment" name="environment" class="form-control" value="${(serviceInstance.defaultEnvironment)!}" required="" autofocus="">
                            <option value="" selected="selected">--- ${labels["select.one"]} ---</option>
                            <#list serviceInstance.environments as environment>
                                <#if environment.active>
                                    <option value="${environment.name}">${environment.label}</option>
                                </#if>
                            </#list>
                        </select>

                    </div>

                    

                   

                    <!--
                    <div class="col-sm-12">

                        <div class="hr-divider">
                            <h3 class="hr-divider-content hr-divider-heading">${labels["sobjects"]}</h3>
                        </div>

                        <br>

                        <div id="auto_load_div">
                            <#include "salesforce-outbound-message-part.html" />
                        </div>

                    </div>
-->
                </div>
            </div>
        </div>

        <#include "confirm-dialog.html"/>
        <#include "spinner.html" />

        <script>

            $('#confirm').click(function(e) {
                $('#confirmDialog').modal('hide');
                $.ajax({
                    url: "/app/connectors/salesforce/connector/${(salesforceConnector.id)!}/service/${(serviceInstance.key)!}",
                    type: "DELETE",
                    success : function(data, status) {
                        window.location.href = "/app/connectors/salesforce/connector/${(salesforceConnector.id)!}";
                    }
                });
            });
            
            
            $('#loginForm').submit(function(e) {
                var params = $("#loginForm").serialize();
                $.ajax({
                    dataType: "html",
                    type: "POST",
                    url: "/app/connectors/salesforce/connector/${(salesforceConnector.id)!}/service/${(serviceInstance.key)!}/sobjects",
                    data: params,
                    complete: function(data) {
                        $("#auto_load_div").html(data.responseText);
                    }
                });

                e.preventDefault();

            });

            $(function() {
                $('select[value]').each(function() {
                    $(this).val(this.getAttribute("value"));
                });
            });

            $("#environment").change(function() {
                alert("Handler for .change() called.");
            });
        </script>

    </@t.page>